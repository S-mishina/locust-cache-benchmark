# version: '3.8'

# services:
#   redis-cluster:
#     image: grokzen/redis-cluster:6.2.14
#     ports:
#       - "7100-7105:7100-7105"
#     environment:
#       - "INITIAL_PORT=7100"
#       - "REDIS_CLUSTER_IP=0.0.0.0"
#       - "IP=0.0.0.0"
#       - "BIND_ADDRESS=0.0.0.0"
#     restart: "no"

version: '3.8'

services:
  redis-cluster:
    image: grokzen/redis-cluster:6.2.14
    container_name: redis-cluster
    ports:
      - "7100:7100"
      - "7101:7101"
      - "7102:7102"
      - "7103:7103"
      - "7104:7104"
      - "7105:7105"
    environment:
      - LC_ALL=C
      - LANG=C
    volumes:
      - ./local-conf/redis.conf:/usr/local/etc/redis/redis.conf
    command: ["redis-server", "/usr/local/etc/redis/redis.conf", "--cluster-enabled", "yes"]
    networks:
      - redis-network

  redis-cli:
    image: redis:6.2.14
    container_name: redis-cli
    entrypoint: ["sleep", "infinity"]
    networks:
      - redis-network
    depends_on:
      - redis-cluster

networks:
  redis-network:
    driver: bridge
